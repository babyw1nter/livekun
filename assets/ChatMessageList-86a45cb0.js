import{_ as M}from"./Paid-40fd08bc.js";import{_ as N}from"./HFont.vue_vue_type_script_setup_true_lang-f9cc6f23.js";import{A as $}from"./index-fa8fc9b6.js";import{d as I,r as _,c as P,X as o,Y as l,a as r,al as u,$ as y,bH as k,aw as w,b5 as A,b6 as U,aq as h,a1 as v,v as j,f as O,z as B,F as x,a0 as E,an as b,bI as G}from"./index-75645e87.js";import{_ as L}from"./_plugin-vue_export-helper-366eeb79.js";import{_ as H}from"./TicketPanel-cf41db27.js";const D=e=>(A("data-v-46581eac"),e=e(),U(),e),R={class:"chat-message"},V={class:"nickname"},F={key:0,class:"yt-icon",style:{color:"#5f84f1"}},Y={viewBox:"0 0 16 16",preserveAspectRatio:"xMidYMid meet",focusable:"false",style:{"pointer-events":"none",display:"block",width:"100%",height:"100%"}},q=D(()=>u("g",null,[u("path",{fill:"currentColor",d:"M9.64589146,7.05569719 C9.83346524,6.562372 9.93617022,6.02722257 9.93617022,5.46808511 C9.93617022,3.00042984 7.93574038,1 5.46808511,1 C4.90894765,1 4.37379823,1.10270499 3.88047304,1.29027875 L6.95744681,4.36725249 L4.36725255,6.95744681 L1.29027875,3.88047305 C1.10270498,4.37379824 1,4.90894766 1,5.46808511 C1,7.93574038 3.00042984,9.93617022 5.46808511,9.93617022 C6.02722256,9.93617022 6.56237198,9.83346524 7.05569716,9.64589147 L12.4098057,15 L15,12.4098057 L9.64589146,7.05569719 Z"})],-1)),K=[q],Q={class:"message"},X=I({__name:"ChatMessage",props:{type:{default:"normal",type:String},avatarUrl:{default:"",type:String},nickname:{default:"",type:String},message:{default:"",type:String},rule:{default:()=>({admin:!1,anchor:!1}),type:Object},guard:{default:Number,type:Number},diamond:{default:!1,type:Boolean},badgeInfo:{default:()=>({badgename:"粉丝牌",level:0}),type:Object},customStyle:{default:()=>({}),type:Object}},setup(e){const s=e;_([]);const m=P(()=>s.rule.anchor?s.customStyle.color.anchor:s.guard>0?s.customStyle.color.guard[`lv${s.guard}`]:s.rule.admin?s.customStyle.color.admin:s.customStyle.color.normal);return(g,n)=>{const f=$,d=N;return o(),l("div",R,[r(f,{class:"chat-message-avatar no-select",src:e.avatarUrl,size:(e.customStyle.fontSize||18)+6},null,8,["src","size"]),u("div",{class:"text-wrap",style:w({paddingLeft:`${(e.customStyle.fontSize||18)+13}px`,lineHeight:`${(e.customStyle.fontSize||18)+2}px`})},[u("p",V,[r(d,{color:y(m).nickname,"font-size":e.customStyle.fontSize,text:`${e.nickname}:`},null,8,["color","font-size","text"]),e.rule.admin?(o(),l("i",F,[(o(),l("svg",Y,K))])):k("",!0)]),u("span",Q,[r(d,{color:y(m).message,"font-size":e.customStyle.fontSize,text:e.message},null,8,["color","font-size","text"])])],4)])}}});const Z=L(X,[["__scopeId","data-v-46581eac"]]),J={key:0,class:"chat-list-message"},W={key:1,class:"chat-list-gift"},ee=I({__name:"ChatMessageList",props:{list:{type:Array,default:()=>[]},smoothScrollInterval:{type:Number,default:250},chatMessageConfig:{type:Object,default:()=>{var e;return(e=h(v.PLUGIN_CHAT_MESSAGE))==null?void 0:e.pluginConfig}},ticketConfig:{type:Object,default:()=>{var e;return(e=h(v.PLUGIN_TICKET))==null?void 0:e.pluginConfig}},paidConfig:{type:Object,default:()=>{var e;return(e=h(v.PLUGIN_PAID))==null?void 0:e.pluginConfig}}},setup(e,{expose:s}){const m=e,g=_(),n=j([]),f=_();O(n,()=>{B(()=>{g.value&&(g.value.scrollTop=g.value.scrollHeight)})});const d=_(!1);let C=0;const z=a=>{var i;if(!a.nickname||!a.message)return;n.length>=m.chatMessageConfig.maximum&&S(n[0].key);const c=new Date().getTime();if(d.value=c-C<m.smoothScrollInterval,C=c,n.push(a),a.messageType==="gift"){const p=a;p.type="",p.message="",(i=f.value)==null||i.add({...p})}},S=a=>{const c=n.findIndex(i=>i.key===a);c>-1&&n.splice(c,1)};return s({add:z,del:S,clear:()=>{var a;n.splice(0,n.length),(a=f.value)==null||a.clear()}}),(a,c)=>{const i=H,p=Z,T=M;return o(),l("div",{class:b(["chat-message-panel",{"show-ticket-panel":e.chatMessageConfig.type.ticket}])},[r(i,{ref_key:"TicketPanelRef",ref:f,maximum:e.ticketConfig.maximum,level:e.ticketConfig.level,duration:e.ticketConfig.duration,class:"chat-message-ticket-panel mb-0"},null,8,["maximum","level","duration"]),u("ul",{ref_key:"dom",ref:g,class:b(["chat-message-list clearfix mb-0",{"smooth-scroll":!y(d)}])},[(o(!0),l(x,null,E(y(n),t=>(o(),l(x,{key:t.key},[t.messageType==="chat"?(o(),l("li",J,[r(p,{"avatar-url":t.avatarUrl,nickname:t.nickname,message:t.message,rule:t.rule,guard:t.guard,badgeInfo:t.badgeInfo,"custom-style":e.chatMessageConfig.customStyle,type:t.type},null,8,["avatar-url","nickname","message","rule","guard","badgeInfo","custom-style","type"])])):k("",!0),t.messageType==="gift"&&e.chatMessageConfig.type.paid?(o(),l("li",W,[r(T,{type:t.type||`level-${y(G)((t==null?void 0:t.money)||0,e.paidConfig.level)}`,"avatar-url":t.avatarUrl,nickname:t.nickname,money:t.money,"gift-name":t.giftName,"gift-count":t.giftCount,"gift-image":t.giftImage,"gift-icon":t.giftIcon,message:t.message,comment:t.comment},null,8,["type","avatar-url","nickname","money","gift-name","gift-count","gift-image","gift-icon","message","comment"])])):k("",!0)],64))),128))],2)],2)}}});const ie=L(ee,[["__scopeId","data-v-ed736099"]]);export{ie as _};
