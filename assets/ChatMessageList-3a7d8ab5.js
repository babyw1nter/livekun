import{_ as w}from"./Paid-dc979e09.js";import{_ as $,P as h}from"./plugins-fd97d438.js";import{A}from"./index-d9c0cdfc.js";import{d as z,r as _,a as U,o,L as c,c as r,H as u,w as x,i as b,I,J as p,ay as k,K as j,ak as O,al as B,b5 as v,z as E,n as G,N as L,M as H,Q as T,ap as V,b6 as D}from"./index-44d985f4.js";import{_ as N}from"./plugin-vueexport-helper-c27b6911.js";import{_ as R}from"./TicketPanel-d41140d3.js";const K=e=>(O("data-v-6571e5e1"),e=e(),B(),e),Q={class:"chat-message"},F={class:"nickname"},J={key:0,class:"yt-icon",style:{color:"#5f84f1"}},Y={viewBox:"0 0 16 16",preserveAspectRatio:"xMidYMid meet",focusable:"false",style:{"pointer-events":"none",display:"block",width:"100%",height:"100%"}},Z=K(()=>u("g",null,[u("path",{fill:"currentColor",d:"M9.64589146,7.05569719 C9.83346524,6.562372 9.93617022,6.02722257 9.93617022,5.46808511 C9.93617022,3.00042984 7.93574038,1 5.46808511,1 C4.90894765,1 4.37379823,1.10270499 3.88047304,1.29027875 L6.95744681,4.36725249 L4.36725255,6.95744681 L1.29027875,3.88047305 C1.10270498,4.37379824 1,4.90894766 1,5.46808511 C1,7.93574038 3.00042984,9.93617022 5.46808511,9.93617022 C6.02722256,9.93617022 6.56237198,9.83346524 7.05569716,9.64589147 L12.4098057,15 L15,12.4098057 L9.64589146,7.05569719 Z"})],-1)),q=[Z],W={class:"message"},X=z({__name:"ChatMessage",props:{type:{default:"normal",type:String},avatarUrl:{default:"",type:String},nickname:{default:"",type:String},message:{default:"",type:String},rule:{default:()=>({admin:!1,anchor:!1}),type:Object},guard:{default:Number,type:Number},diamond:{default:!1,type:Boolean},badgeInfo:{default:()=>({badgename:"粉丝牌",level:0}),type:Object},customStyle:{default:()=>({}),type:Object}},setup(e){const s=e;_([]);const m=U(()=>s.rule.anchor?s.customStyle.color.anchor:s.guard>0?s.customStyle.color.guard[`lv${s.guard}`]:s.rule.admin?s.customStyle.color.admin:s.customStyle.color.normal);return(f,n)=>{const g=A,d=$;return o(),c("div",Q,[r(g,{class:"chat-message-avatar no-select",src:e.avatarUrl,size:(e.customStyle.fontSize||18)+6},null,8,["src","size"]),u("div",{class:"text-wrap",style:j({paddingLeft:`${(e.customStyle.fontSize||18)+13}px`,lineHeight:`${(e.customStyle.fontSize||18)+2}px`})},[u("p",F,[r(d,{color:p(m).nickname,"font-size":e.customStyle.fontSize},{default:x(()=>[b(I(`${e.nickname}:`),1)]),_:1},8,["color","font-size"]),e.rule.admin?(o(),c("i",J,[(o(),c("svg",Y,q))])):k("",!0)]),u("span",W,[r(d,{color:p(m).message,"font-size":e.customStyle.fontSize},{default:x(()=>[b(I(e.message),1)]),_:1},8,["color","font-size"])])],4)])}}});const ee=N(X,[["__scopeId","data-v-6571e5e1"]]),te={key:0,class:"chat-list-message"},ae={key:1,class:"chat-list-gift"},se=z({__name:"ChatMessageList",props:{list:{type:Array,default:()=>[]},smoothScrollInterval:{type:Number,default:250},chatMessageConfig:{type:Object,default:()=>v(h.PLUGIN_CHAT_MESSAGE)},ticketConfig:{type:Object,default:()=>v(h.PLUGIN_TICKET)},paidConfig:{type:Object,default:()=>v(h.PLUGIN_PAID)}},setup(e,{expose:s}){const m=e,f=_(),n=E([]),g=_();G(n,()=>{V(()=>{f.value&&(f.value.scrollTop=f.value.scrollHeight)})});const d=_(!1);let C=0;const M=a=>{var i;if(!a.nickname||!a.message)return;n.length>=m.chatMessageConfig.maximum&&S(n[0].key);const l=new Date().getTime();if(d.value=l-C<m.smoothScrollInterval,C=l,n.push(a),a.messageType==="gift"){const y=a;y.type="",y.message="",(i=g.value)==null||i.add({...y})}},S=a=>{const l=n.findIndex(i=>i.key===a);l>-1&&n.splice(l,1)};return s({add:M,del:S,clear:()=>{var a;n.splice(0,n.length),(a=g.value)==null||a.clear()}}),(a,l)=>{const i=R,y=ee,P=w;return o(),c("div",{class:T(["chat-message-panel",{"show-ticket-panel":e.chatMessageConfig.type.ticket}])},[r(i,{ref_key:"TicketPanelRef",ref:g,maximum:e.ticketConfig.maximum,level:e.ticketConfig.level,duration:e.ticketConfig.duration,class:"chat-message-ticket-panel mb-0"},null,8,["maximum","level","duration"]),u("ul",{ref_key:"dom",ref:f,class:T(["chat-message-list clearfix mb-0",{"smooth-scroll":!p(d)}])},[(o(!0),c(L,null,H(p(n),t=>(o(),c(L,{key:t.key},[t.messageType==="chat"?(o(),c("li",te,[r(y,{"avatar-url":t.avatarUrl,nickname:t.nickname,message:t.message,rule:t.rule,guard:t.guard,badgeInfo:t.badgeInfo,"custom-style":e.chatMessageConfig.customStyle,type:t.type},null,8,["avatar-url","nickname","message","rule","guard","badgeInfo","custom-style","type"])])):k("",!0),t.messageType==="gift"&&e.chatMessageConfig.type.paid?(o(),c("li",ae,[r(P,{type:t.type||`level-${p(D)((t==null?void 0:t.money)||0,e.paidConfig.level)}`,"avatar-url":t.avatarUrl,nickname:t.nickname,money:t.money,"gift-name":t.giftName,"gift-count":t.giftCount,"gift-image":t.giftImage,"gift-icon":t.giftIcon,message:t.message,comment:t.comment},null,8,["type","avatar-url","nickname","money","gift-name","gift-count","gift-image","gift-icon","message","comment"])])):k("",!0)],64))),128))],2)],2)}}});const me=N(se,[["__scopeId","data-v-36c872ae"]]);export{me as _};
