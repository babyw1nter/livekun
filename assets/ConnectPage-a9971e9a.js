import{X as S,F as d,Y as n,d as R,D as P,r as m,o as b,L as x,c as a,w as c,J as e,H as $,O as j,i as f,B}from"./index-78e5fa77.js";import{_ as J}from"./index-90a0a622.js";import{I as k}from"./index-3b031b7c.js";import{_ as D}from"./index-c5202129.js";import{C as N}from"./index-20dbe808.js";import"./index-3035e269.js";import"./TextArea-eb0d299f.js";import"./SearchOutlined-6c99f03a.js";import"./useFlexGapSupport-52915c14.js";import"./index-3886e6a1.js";import"./collapseMotion-d1a0c701.js";import"./Dropdown-88c4de46.js";import"./hasIn-66a787ba.js";import"./useMergedState-64ce77ff.js";const V=S("connentStore",{state(){return{isJoinedRoom:!1,roomInfo:{liveId:"",title:""}}},actions:{async getStatus(){const t=await d.get("/api/getStatus");return t.data.code===200?(this.$state=t.data.data,Promise.resolve(!0)):(this.$reset(),Promise.resolve(!1))},async joinRoom(t){const o=await d.post("/api/join",{liveId:t.toString()});return o.data.code===200?(this.$state=o.data.data,n.success("进入直播间成功！"),await this.getStatus(),Promise.resolve(!0)):(o.data.code===10001?n.warning("进入直播间失败，请稍后再试！"):n.error("服务器错误！"),await this.getStatus(),Promise.resolve(!1))},async reset(){const t=await d.post("/api/reset");return t.data.code===200?(this.$reset(),await this.getStatus(),n.success("重置成功！"),Promise.resolve(!0)):(n.warning(t.data.message),await this.getStatus(),Promise.resolve(!1))}}}),L={class:"connect-page-wrapper"},z={class:"join-input-wrap",style:{"margin-top":"1rem"}},Z=R({__name:"ConnectPage",async setup(t){let o,u;const s=V();[o,u]=P(()=>s.getStatus()),await o,u();const i=m(""),l=m(!1),r=m(!1),g=async()=>{i.value?(l.value=!0,await s.joinRoom(i.value),l.value=!1):n.warning("请输入直播间ID或房间ID！")},v=async()=>{r.value=!0,await s.reset(),r.value=!1};return(A,p)=>{const w=J,y=k,_=B,h=D,I=N;return b(),x("div",L,[a(I,null,{default:c(()=>[a(w,{message:e(s).isJoinedRoom?`已连接 ${e(s).roomInfo.liveId}`:"未连接",description:e(s).isJoinedRoom?`已进入直播间「${e(s).roomInfo.title}」`:"请进入一个直播间以使用所有功能。",type:e(s).isJoinedRoom?"success":"info",style:{"margin-bottom":"1rem"},"show-icon":""},null,8,["message","description","type"]),$("div",z,[a(h,{size:10},{default:c(()=>[a(y,{value:e(i),"onUpdate:value":p[0]||(p[0]=C=>j(i)?i.value=C:null),placeholder:"请输入直播间ID",disabled:e(l)||e(r),allowClear:""},null,8,["value","disabled"]),a(_,{onClick:g,type:"primary",loading:e(l),disabled:e(r)},{default:c(()=>[f(" 进入 ")]),_:1},8,["loading","disabled"]),a(_,{onClick:v,danger:"",loading:e(r)},{default:c(()=>[f(" 重置 ")]),_:1},8,["loading"])]),_:1})])]),_:1})])}}});export{Z as default};
