import{_ as P}from"./Paid-71052b12.js";import{_ as w}from"./HFont.vuevuetypescriptsetuptruelang-17433834.js";import{A}from"./index-c9a3e32a.js";import{d as z,r as _,c as U,X as o,Y as c,a as r,aq as u,Z as b,g as x,a7 as I,$ as y,bH as k,aA as j,b5 as O,b6 as B,av as h,a1 as v,v as D,f as E,z as G,F as L,a0 as H,as as T,bI as V}from"./index-76b20fec.js";import{_ as N}from"./plugin-vueexport-helper-880d0091.js";import{_ as R}from"./TicketPanel-cb1ef242.js";const F=e=>(O("data-v-cd29753b"),e=e(),B(),e),Y={class:"chat-message"},Z={class:"nickname"},q={key:0,class:"yt-icon",style:{color:"#5f84f1"}},K={viewBox:"0 0 16 16",preserveAspectRatio:"xMidYMid meet",focusable:"false",style:{"pointer-events":"none",display:"block",width:"100%",height:"100%"}},Q=F(()=>u("g",null,[u("path",{fill:"currentColor",d:"M9.64589146,7.05569719 C9.83346524,6.562372 9.93617022,6.02722257 9.93617022,5.46808511 C9.93617022,3.00042984 7.93574038,1 5.46808511,1 C4.90894765,1 4.37379823,1.10270499 3.88047304,1.29027875 L6.95744681,4.36725249 L4.36725255,6.95744681 L1.29027875,3.88047305 C1.10270498,4.37379824 1,4.90894766 1,5.46808511 C1,7.93574038 3.00042984,9.93617022 5.46808511,9.93617022 C6.02722256,9.93617022 6.56237198,9.83346524 7.05569716,9.64589147 L12.4098057,15 L15,12.4098057 L9.64589146,7.05569719 Z"})],-1)),X=[Q],J={class:"message"},W=z({__name:"ChatMessage",props:{type:{default:"normal",type:String},avatarUrl:{default:"",type:String},nickname:{default:"",type:String},message:{default:"",type:String},rule:{default:()=>({admin:!1,anchor:!1}),type:Object},guard:{default:Number,type:Number},diamond:{default:!1,type:Boolean},badgeInfo:{default:()=>({badgename:"粉丝牌",level:0}),type:Object},customStyle:{default:()=>({}),type:Object}},setup(e){const s=e;_([]);const m=U(()=>s.rule.anchor?s.customStyle.color.anchor:s.guard>0?s.customStyle.color.guard[`lv${s.guard}`]:s.rule.admin?s.customStyle.color.admin:s.customStyle.color.normal);return(g,n)=>{const f=A,d=w;return o(),c("div",Y,[r(f,{class:"chat-message-avatar no-select",src:e.avatarUrl,size:(e.customStyle.fontSize||18)+6},null,8,["src","size"]),u("div",{class:"text-wrap",style:j({paddingLeft:`${(e.customStyle.fontSize||18)+13}px`,lineHeight:`${(e.customStyle.fontSize||18)+2}px`})},[u("p",Z,[r(d,{color:y(m).nickname,"font-size":e.customStyle.fontSize},{default:b(()=>[x(I(`${e.nickname}:`),1)]),_:1},8,["color","font-size"]),e.rule.admin?(o(),c("i",q,[(o(),c("svg",K,X))])):k("",!0)]),u("span",J,[r(d,{color:y(m).message,"font-size":e.customStyle.fontSize},{default:b(()=>[x(I(e.message),1)]),_:1},8,["color","font-size"])])],4)])}}});const ee=N(W,[["__scopeId","data-v-cd29753b"]]),te={key:0,class:"chat-list-message"},ae={key:1,class:"chat-list-gift"},se=z({__name:"ChatMessageList",props:{list:{type:Array,default:()=>[]},smoothScrollInterval:{type:Number,default:250},chatMessageConfig:{type:Object,default:()=>{var e;return(e=h(v.PLUGIN_CHAT_MESSAGE))==null?void 0:e.pluginConfig}},ticketConfig:{type:Object,default:()=>{var e;return(e=h(v.PLUGIN_TICKET))==null?void 0:e.pluginConfig}},paidConfig:{type:Object,default:()=>{var e;return(e=h(v.PLUGIN_PAID))==null?void 0:e.pluginConfig}}},setup(e,{expose:s}){const m=e,g=_(),n=D([]),f=_();E(n,()=>{G(()=>{g.value&&(g.value.scrollTop=g.value.scrollHeight)})});const d=_(!1);let C=0;const M=a=>{var i;if(!a.nickname||!a.message)return;n.length>=m.chatMessageConfig.maximum&&S(n[0].key);const l=new Date().getTime();if(d.value=l-C<m.smoothScrollInterval,C=l,n.push(a),a.messageType==="gift"){const p=a;p.type="",p.message="",(i=f.value)==null||i.add({...p})}},S=a=>{const l=n.findIndex(i=>i.key===a);l>-1&&n.splice(l,1)};return s({add:M,del:S,clear:()=>{var a;n.splice(0,n.length),(a=f.value)==null||a.clear()}}),(a,l)=>{const i=R,p=ee,$=P;return o(),c("div",{class:T(["chat-message-panel",{"show-ticket-panel":e.chatMessageConfig.type.ticket}])},[r(i,{ref_key:"TicketPanelRef",ref:f,maximum:e.ticketConfig.maximum,level:e.ticketConfig.level,duration:e.ticketConfig.duration,class:"chat-message-ticket-panel mb-0"},null,8,["maximum","level","duration"]),u("ul",{ref_key:"dom",ref:g,class:T(["chat-message-list clearfix mb-0",{"smooth-scroll":!y(d)}])},[(o(!0),c(L,null,H(y(n),t=>(o(),c(L,{key:t.key},[t.messageType==="chat"?(o(),c("li",te,[r(p,{"avatar-url":t.avatarUrl,nickname:t.nickname,message:t.message,rule:t.rule,guard:t.guard,badgeInfo:t.badgeInfo,"custom-style":e.chatMessageConfig.customStyle,type:t.type},null,8,["avatar-url","nickname","message","rule","guard","badgeInfo","custom-style","type"])])):k("",!0),t.messageType==="gift"&&e.chatMessageConfig.type.paid?(o(),c("li",ae,[r($,{type:t.type||`level-${y(V)((t==null?void 0:t.money)||0,e.paidConfig.level)}`,"avatar-url":t.avatarUrl,nickname:t.nickname,money:t.money,"gift-name":t.giftName,"gift-count":t.giftCount,"gift-image":t.giftImage,"gift-icon":t.giftIcon,message:t.message,comment:t.comment},null,8,["type","avatar-url","nickname","money","gift-name","gift-count","gift-image","gift-icon","message","comment"])])):k("",!0)],64))),128))],2)],2)}}});const me=N(se,[["__scopeId","data-v-ed736099"]]);export{me as _};
